<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="phaser.min.js"></script>
    <script src="src/error.js"></script>
    <script src="src/utils.js"></script>
    <script src="src/tracks.js"></script>
    <script src="src/tile.js"></script>
    <script src="src/driver.js"></script>
    <script src="src/cardriver.js"></script>
    <script src="src/tramdriver.js"></script>
    <script src="src/bezier.js"></script>
    <script src="src/vehicle.js"></script>
    <script src="src/car.js"></script>
    <script src="src/tram.js"></script>
    <script src="test/bezier_test.js"></script>
    <script src="test/util_test.js"></script>
    <script src="test/vehicle_test.js"></script>
    <script src="test/tile_test.js"></script>
    <script src="test/tracks_test.js"></script>
    <style type="text/css">
        #spinner {
            position: absolute;
            left: calc(50vw - 76px);
            top: calc(50vh - 76px);
            border: 16px dashed #000000;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 3s linear infinite;
        }
        #result {
            font: 40px Arial;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="spinner"></div>
    <div id="result"></div>
    <script>
        var game = new Phaser.Game(1, 1, Phaser.CANVAS, '', { preload: preload, create: create });
        var config;

        function preload() {
            game.load.json('config', 'config.json');
        }

        function displayText(message) {
            document.getElementById('spinner').style.display = 'none';
            document.getElementById('result').innerHTML = message;
        }

        function displayError(error) {
            var file = error.stack.split('\n')[1].split('\/');
            displayText(file[file.length-1]);
        }

        function create() {
            config = game.cache.getJSON('config');
            try {
                new BezierCurveTest();
                new UtilTest();
                new TileTest();
                new TracksTest();
                new VehicleTest();
            } catch (e) {
                displayError(e);
                throw e;
            }
            displayText('Tests successful');
        }
    </script>
</body>
</html>
